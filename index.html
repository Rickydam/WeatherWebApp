<html>
  <header>
    <title> Weather WebApp </title>
    <link rel="shortcut icon" href="icon.png">
    <link href="font-awesome.min.css" rel="stylesheet" type="text/css" >
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel='stylesheet' type='text/css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <font face="Source Sans Pro" size="5">
  </header>
  <body>
    <div class="container-fluid">
      <br>
      <div class="col-xs-3">
        <input class="form-control" placeholder="Enter your API key" id="theInput"/>
        <input type="button" class="btn btn-primary" value="Get Your Location Weather!" onclick="getCoords()"/><br><br>
      </div><br><br><br>
      <span> URL: </span><b><span id="url"></span></b><br><br>

      <span> Longitude: </span><b><span id="longitude"></span></b><br>
      &nbsp;&nbsp;&nbsp; <span> Latitude: </span><b><span id="latitude"></span></b><br><br>

      <span> City: </span><b><span id="city"></span></b><br>
      <span> Country: </span><b><span id="country"></span></b><br><br>

      <span> Temperature (Celsius): </span><font size="7"><b><span id="temperature"></span></b></font>
    </div>
  </body>
</html>

<script>
  var getCoords = function() {
    theKey = document.getElementById('theInput').value;
    if(theKey.length < 20) {
      alert("This is probably not an API key, try again.");
    }
    else {
      url = "http://api.openweathermap.org/data/2.5/weather?";
      if(navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(getLocation, displayError);
      }
      else {
        alert("Error.");
      }
    }
  };

  var getLocation = function(position) {
    var longitude;
    var latitude;
    var url = "http://api.openweathermap.org/data/2.5/weather?";
    var jsonData;
    longitude = position.coords.longitude;
    latitude = position.coords.latitude;
    document.getElementById("longitude").innerHTML = position.coords.longitude;
    document.getElementById("latitude").innerHTML = position.coords.latitude;

    url = url + "lat=" + latitude + "&";
    url = url + "lon=" + longitude;
    url = url + "&appid=";
    url = url + theKey;
    url = url + "&units=metric";

    document.getElementById("url").innerHTML = url;

    $.getJSON(url, function(data) {
        jsonData = data;
        $('#temperature').text(jsonData.main.temp);
        $('#city').text(jsonData.name);
        $('#country').text(jsonData.sys.country);
    });
  }

  var displayError = function (error) {
    alert("An error has occurred." + error);
  }
</script>
